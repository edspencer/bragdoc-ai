---
phase: 06-cleanup
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/lib/plans.ts
  - packages/config/src/payment-gates.ts
  - packages/config/src/index.ts
  - apps/web/scripts/create-stripe-products.ts
  - apps/marketing/components/pricing/pricing-tiers.tsx
  - apps/marketing/components/pricing/pricing-faq.tsx
  - apps/marketing/components/pricing/pricing-header.tsx
  - apps/marketing/components/pricing/comparison-table.tsx
  - apps/marketing/components/pricing/hybrid-approach.tsx
  - apps/marketing/components/structured-data/software-application-schema.tsx
  - apps/marketing/app/pricing/page.tsx
  - apps/marketing/lib/faq-data.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "No imports of apps/web/lib/plans.ts exist in codebase"
    - "No imports of packages/config/src/payment-gates.ts exist in codebase"
    - "Marketing pricing pages show $45/year or $99 lifetime"
    - "No references to $4.99, $5/month, $9/month, $30/year, or $90/year in marketing copy"
    - "pnpm build succeeds without errors"
  artifacts:
    - path: "apps/web/lib/plans.ts"
      provides: "Removed - file should not exist"
    - path: "packages/config/src/payment-gates.ts"
      provides: "Removed - file should not exist"
    - path: "packages/config/src/index.ts"
      provides: "Config package exports without payment-gates"
      min_lines: 1
    - path: "apps/marketing/components/pricing/pricing-tiers.tsx"
      provides: "Updated pricing display with $45/year and $99 lifetime options"
      contains: "$45"
  key_links:
    - from: "packages/config/src/index.ts"
      to: "N/A"
      via: "Removed payment-gates export"
      pattern: "^(?!.*payment-gates)"
---

<objective>
Remove legacy pricing tier code and update marketing site to reflect new simplified pricing.

Purpose: The new pricing model ($45/year or $99 lifetime) replaces the old four-tier system (Free/Basic/Pro/Demo). Legacy code references must be removed to prevent confusion and reduce maintenance burden.

Output: Clean codebase with no Basic/Pro tier references in active code, marketing site displaying new pricing.
</objective>

<execution_context>
@/Users/ed/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ed/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-cleanup/06-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Remove legacy pricing code files</name>
  <files>
    apps/web/lib/plans.ts
    packages/config/src/payment-gates.ts
    packages/config/src/index.ts
    apps/web/scripts/create-stripe-products.ts
  </files>
  <action>
    1. DELETE `apps/web/lib/plans.ts` entirely - contains legacy Basic/Pro tier definitions

    2. DELETE `packages/config/src/payment-gates.ts` entirely - contains old tier-based feature gates that are replaced by the credit system

    3. UPDATE `packages/config/src/index.ts` to remove the payment-gates export:
       - Remove line: `export * from './payment-gates';`
       - Keep only: `export { default } from './config';`

    4. DELETE `apps/web/scripts/create-stripe-products.ts` - obsolete script for old Stripe products

    Note: Per decision [01-01], do NOT remove enum values from database schema.ts - those are kept for PostgreSQL compatibility. This task only removes the application-level tier definitions.
  </action>
  <verify>
    ```bash
    # Verify files are deleted
    ls apps/web/lib/plans.ts 2>&1 | grep -q "No such file"
    ls packages/config/src/payment-gates.ts 2>&1 | grep -q "No such file"
    ls apps/web/scripts/create-stripe-products.ts 2>&1 | grep -q "No such file"

    # Verify index.ts no longer exports payment-gates
    grep -q "payment-gates" packages/config/src/index.ts && echo "FAIL: still exports payment-gates" || echo "PASS"

    # Verify no broken imports
    pnpm tsc --noEmit -p packages/config
    ```
  </verify>
  <done>
    - apps/web/lib/plans.ts deleted
    - packages/config/src/payment-gates.ts deleted
    - apps/web/scripts/create-stripe-products.ts deleted
    - packages/config/src/index.ts updated (no payment-gates export)
    - TypeScript compilation passes for config package
  </done>
</task>

<task type="auto">
  <name>Task 2: Update marketing site pricing to new model</name>
  <files>
    apps/marketing/components/pricing/pricing-tiers.tsx
    apps/marketing/components/pricing/pricing-faq.tsx
    apps/marketing/components/pricing/pricing-header.tsx
    apps/marketing/components/pricing/comparison-table.tsx
    apps/marketing/components/pricing/hybrid-approach.tsx
    apps/marketing/components/structured-data/software-application-schema.tsx
    apps/marketing/app/pricing/page.tsx
    apps/marketing/lib/faq-data.ts
  </files>
  <action>
    Update all marketing pricing references from beta pricing ($4.99/mo, $44.99/yr) to the new simplified pricing model:
    - **Annual plan**: $45/year (can be marketed as "$3.75/month, billed annually")
    - **Lifetime plan**: $99 one-time purchase

    **Note on messaging**: The marketing site currently emphasizes "FREE during beta." Per the research open question, this plan will update to post-beta pricing since the new credit system is now implemented. The messaging should reflect launch pricing while acknowledging free trial credits (10 LLM credits + 20 chat messages).

    Files to update:

    1. **pricing-tiers.tsx**:
       - Remove monthly/annual toggle (only annual and lifetime now)
       - Change "FREE During Beta" to show actual pricing
       - Update strikethrough pricing to new values ($45/year, $99 lifetime)
       - Update Full Account card to show both options
       - Keep Free Account section but update description to mention trial credits

    2. **pricing-header.tsx**:
       - Update from "Future pricing $4.99/month" to "$45/year or $99 lifetime"
       - Update tagline to reflect new model with free trial credits

    3. **pricing-faq.tsx**:
       - Update all beta pricing references ($4.99/month, $44.99/year) to new pricing
       - Update "What happens when beta ends?" to reflect current pricing
       - Update billing explanation with new amounts
       - Mention free trial credits (10 LLM credits, 20 chat messages)

    4. **comparison-table.tsx**:
       - Update Cost row from "FREE (Beta)" and "$4.99/mo" to new pricing
       - Show "$45/year or $99 lifetime" for Full Account

    5. **hybrid-approach.tsx**:
       - Update "$4.99/month" references to "$45/year"

    6. **software-application-schema.tsx**:
       - Update offers.price and description to reflect new pricing

    7. **apps/marketing/app/pricing/page.tsx**:
       - Update metadata description from "$4.99/month" to new pricing
       - Update pricingOffers array with correct prices

    8. **apps/marketing/lib/faq-data.ts**:
       - Update "Pricing & Billing" category with new pricing
       - Update all $4.99/month references to $45/year or $99 lifetime
       - Add mention of free trial credits
  </action>
  <verify>
    ```bash
    # Check for old pricing references in marketing components
    grep -r "\$4\.99\|\$44\.99\|\$5/\|\$9/\|\$30/\|\$90/" apps/marketing/components/pricing/ apps/marketing/lib/faq-data.ts apps/marketing/app/pricing/page.tsx && echo "FAIL: old pricing found" || echo "PASS: no old pricing"

    # Verify new pricing exists
    grep -q "\$45" apps/marketing/components/pricing/pricing-tiers.tsx && echo "PASS: $45 found" || echo "FAIL: $45 missing"
    grep -q "\$99" apps/marketing/components/pricing/pricing-tiers.tsx && echo "PASS: $99 found" || echo "FAIL: $99 missing"

    # Build check
    pnpm --filter=@bragdoc/marketing build
    ```
  </verify>
  <done>
    - All marketing pricing components updated to $45/year and $99 lifetime
    - No references to old beta pricing ($4.99/mo, $44.99/yr) remain
    - No references to Basic/Pro tier pricing ($5, $9, $30, $90) remain
    - Marketing site builds successfully
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify full build and search for remaining legacy references</name>
  <files>N/A - verification only</files>
  <action>
    Run comprehensive verification to ensure cleanup is complete:

    1. Run full monorepo build to catch any broken imports
    2. Search for remaining legacy tier references in active code (excluding .planning/, docs/, comments)
    3. Verify no TypeScript errors

    Expected remaining legacy references (acceptable):
    - `packages/database/src/schema.ts` - enum values kept per decision [01-01]
    - `.planning/` directory - planning documentation
    - `docs/` directory - will be updated in Plan 02
    - Comments mentioning historical context

    Unexpected references requiring investigation:
    - Any import of deleted files
    - Any active code using BasicAchiever/ProAchiever/basic_monthly/pro_yearly patterns
  </action>
  <verify>
    ```bash
    # Full build
    pnpm build

    # Search for legacy references (excluding expected locations)
    grep -r "basic_monthly\|basic_yearly\|pro_monthly\|pro_yearly\|BasicAchiever\|ProAchiever" \
      --include="*.ts" --include="*.tsx" \
      apps/ packages/ \
      | grep -v "\.planning\|schema\.ts\|\.test\." \
      && echo "FAIL: unexpected legacy references" || echo "PASS: no unexpected legacy references"

    # Verify tests still pass
    pnpm test
    ```
  </verify>
  <done>
    - pnpm build completes without errors
    - pnpm test passes
    - No unexpected legacy tier references in active code
    - Only schema.ts enum values remain (intentional per [01-01])
  </done>
</task>

</tasks>

<verification>
Phase 6 Plan 01 verification checklist:
- [ ] `apps/web/lib/plans.ts` does not exist
- [ ] `packages/config/src/payment-gates.ts` does not exist
- [ ] `apps/web/scripts/create-stripe-products.ts` does not exist
- [ ] `packages/config/src/index.ts` exports only config, not payment-gates
- [ ] Marketing site shows $45/year and $99 lifetime pricing
- [ ] No old pricing references ($4.99, $5, $9, $30, $90) in marketing components
- [ ] `pnpm build` succeeds
- [ ] `pnpm test` passes
</verification>

<success_criteria>
1. Legacy pricing code removed (plans.ts, payment-gates.ts, create-stripe-products.ts)
2. Marketing site displays new pricing model ($45/year or $99 lifetime)
3. No broken imports or TypeScript errors
4. Full monorepo build succeeds
5. Tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/06-cleanup/06-01-SUMMARY.md`
</output>
